{% extends 'main/base.html' %}
{% load static %}

{% block title %}–ö–∞—Ç–∞–ª–æ–≥ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π{% endblock %}

{% block content %}
<div class="container my-5">

    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü—ã -->
    <h1 class="text-center mb-4 display-5 fw-semibold">–ö–∞—Ç–∞–ª–æ–≥ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π</h1>

    <!-- –§–æ—Ä–º–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ -->
    <form method="GET" class="row g-2 mb-5">
        <div class="col-md-3">
            <input 
                type="text" 
                name="search" 
                class="form-control" 
                placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é..." 
                value="{{ search_query }}"
            >
        </div>

        <div class="col-md-2">
            <input 
                type="number" 
                name="min_price" 
                class="form-control" 
                placeholder="–ú–∏–Ω. —Ü–µ–Ω–∞" 
                value="{{ min_price }}"
            >
        </div>

        <div class="col-md-2">
            <input 
                type="number" 
                name="max_price" 
                class="form-control" 
                placeholder="–ú–∞–∫—Å. —Ü–µ–Ω–∞" 
                value="{{ max_price }}"
            >
        </div>

        <div class="col-md-3">
            <select name="sort_by" class="form-select">
                <option value="" {% if not sort_by %}selected{% endif %}>–ë–µ–∑ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏</option>
                <option value="price_asc" {% if sort_by == 'price_asc' %}selected{% endif %}>–¶–µ–Ω–∞ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é</option>
                <option value="price_desc" {% if sort_by == 'price_desc' %}selected{% endif %}>–¶–µ–Ω–∞ –ø–æ —É–±—ã–≤–∞–Ω–∏—é</option>
                <option value="name_asc" {% if sort_by == 'name_asc' %}selected{% endif %}>–ù–∞–∑–≤–∞–Ω–∏–µ (A-Z)</option>
                <option value="name_desc" {% if sort_by == 'name_desc' %}selected{% endif %}>–ù–∞–∑–≤–∞–Ω–∏–µ (Z-A)</option>
            </select>
        </div>

        <div class="col-md-2 d-flex">
            <button type="submit" class="btn btn-primary me-2 w-50">
                –ü—Ä–∏–º–µ–Ω–∏—Ç—å
            </button>
            <a href="{% url 'car_list' %}" class="btn btn-outline-secondary w-50">
                –°–±—Ä–æ—Å–∏—Ç—å
            </a>
        </div>
    </form>

    <!-- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±—Ä–µ–Ω–¥–æ–≤ -->
    <h2 class="mb-4">–ë—Ä–µ–Ω–¥—ã –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π</h2>
    <div class="row row-cols-2 row-cols-md-4 g-3">
        {% for brand in brands %}
            <div class="col">
                <div class="card h-100 text-center shadow-sm hover-zoom">
                    <!-- –õ–æ–≥–æ—Ç–∏–ø –±—Ä–µ–Ω–¥–∞ -->
                    <a href="{% url 'brand_cars' brand.slug %}" class="text-decoration-none">
                        {% if brand.logo %}
                            <img 
                                src="{{ brand.logo.url }}" 
                                alt="{{ brand.name }}" 
                                class="card-img-top" 
                                style="max-height: 120px; object-fit: contain;"
                            >
                        {% else %}
                            <div 
                                class="card-img-top d-flex align-items-center justify-content-center" 
                                style="height: 120px; background-color: #f8f9fa;"
                            >
                                <i class="bi bi-card-image" style="font-size: 2rem; color: #adb5bd;"></i>
                            </div>
                        {% endif %}
                    </a>
                    <div class="card-body d-flex flex-column justify-content-center">
                        <h5 class="card-title mb-3">
                            <a 
                                href="{% url 'brand_cars' brand.slug %}" 
                                class="text-decoration-none text-dark"
                            >
                                {{ brand.name }}
                            </a>
                        </h5>
                        <p class="card-text mb-0">
                            –ú–∞—à–∏–Ω –≤ –Ω–∞–ª–∏—á–∏–∏: <span class="fw-bold">{{ brand.car_count }}</span>
                        </p>
                    </div>
                </div>
            </div>
        {% empty %}
            <p class="text-center">–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –±—Ä–µ–Ω–¥–æ–≤.</p>
        {% endfor %}
    </div>

    <!-- –í—ã–≤–æ–¥ —Å–ø–∏—Å–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π (–ª–∏–±–æ –≤—Å–µ—Ö, –ª–∏–±–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –±—Ä–µ–Ω–¥–∞) -->
    <div class="mt-5">
        {% if selected_brand %}
            <h2 class="mb-4">–í—Å–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ –±—Ä–µ–Ω–¥–∞ {{ selected_brand.name }}</h2>
        {% else %}
            <h2 class="mb-4">–í—Å–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏</h2>
        {% endif %}

        {% if cars %}
            <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
                {% for car in cars %}
                <div class="col">
                    <div class="card h-100 shadow-sm hover-zoom">
                        <!-- –û–±–æ—Ä–∞—á–∏–≤–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ —Å—Å—ã–ª–∫—É, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –µ–≥–æ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–º -->
                        <a href="{% url 'car_detail' car.id %}" class="text-decoration-none text-dark">
                            {% if car.image %}
                                <img 
                                    src="{{ car.image.url }}" 
                                    class="card-img-top"
                                    alt="{{ car.name }}"
                                    style="height: 180px; object-fit: cover;"
                                >
                            {% else %}
                                <img 
                                    src="{% static 'no_image.jpg' %}" 
                                    class="card-img-top" 
                                    alt="–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è"
                                    style="height: 180px; object-fit: cover;"
                                >
                            {% endif %}
                        </a>
                        <div class="card-body d-flex flex-column">
                            <h5 class="card-title">{{ car.name }}</h5>
                            <p class="card-text fw-bold">{{ car.price }} ‚ÇΩ</p>
                            <div class="mt-auto">
                                <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –Ω–∞ –¥–µ—Ç–∞–ª—å–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ -->
                                <a href="{% url 'car_detail' car.id %}" class="btn btn-outline-primary w-100">
                                    –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                                </a>
                            </div>
                        </div>
                    </div>
                </div>                
                {% endfor %}
            </div>
        {% else %}
            <p class="text-center">–ê–≤—Ç–æ–º–æ–±–∏–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.</p>
        {% endif %}

        {% if selected_brand %}
            <div class="text-center mt-4">
                <a href="{% url 'car_list' %}" class="btn btn-outline-danger btn-lg">
                    üîÑ –°–±—Ä–æ—Å–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä
                </a>
            </div>
        {% endif %}
    </div>
</div>

<!-- –†–∞–∑–¥–µ–ª "–ù–∞—à–∏ —É—Å–ª—É–≥–∏" -->
<div class="container mt-5">
    <h2 class="mb-4 text-center">–ù–∞—à–∏ —É—Å–ª—É–≥–∏</h2>
    <div class="row row-cols-1 row-cols-md-2 row-cols-lg-4 g-4">

        <div class="col text-center">
            <div class="service-icon">
                <i class="bi bi-car-front-fill fs-1"></i>
            </div>
            <h5 class="mt-3">–ü—Ä–æ–¥–∞–∂–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π</h5>
            <p>–®–∏—Ä–æ–∫–∏–π –≤—ã–±–æ—Ä –Ω–æ–≤—ã—Ö –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π –∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π —Å –ø—Ä–æ–±–µ–≥–æ–º.</p>
        </div>

        <div class="col text-center">
            <div class="service-icon">
                <i class="bi bi-flag-fill fs-1"></i>
            </div>
            <h5 class="mt-3">–¢–µ—Å—Ç-–¥—Ä–∞–π–≤</h5>
            <p>–ü—Ä–æ–π–¥–∏—Ç–µ —Ç–µ—Å—Ç-–¥—Ä–∞–π–≤ –ø–æ–Ω—Ä–∞–≤–∏–≤—à–µ–π—Å—è –º–æ–¥–µ–ª–∏.</p>
        </div>

        <div class="col text-center">
            <div class="service-icon">
                <i class="bi bi-wallet-fill fs-1"></i>
            </div>
            <h5 class="mt-3">–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —É—Å–ª—É–≥–∏</h5>
            <p>–ü–æ–∫—É–ø–∫–∞ –∞–≤—Ç–æ–º–æ–±–∏–ª—è –≤ –∫—Ä–µ–¥–∏—Ç –∏–ª–∏ –ª–∏–∑–∏–Ω–≥.</p>
        </div>

        <div class="col text-center">
            <div class="service-icon">
                <i class="bi bi-tools fs-1"></i>
            </div>
            <h5 class="mt-3">–°–µ—Ä–≤–∏—Å</h5>
            <p>–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏ —Ä–µ–º–æ–Ω—Ç –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π.</p>
        </div>
    </div>
</div>

<!-- –†–∞–∑–¥–µ–ª "–û –Ω–∞—Å" -->
<div class="about-section mt-5">
    <div class="dark-overlay">
        <div class="container text-light py-5 text-center">
            <h2 class="display-6 fw-bold">–û –Ω–∞—Å</h2>
            <p class="lead">
                –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ <strong>–ê–≤—Ç–æ –°–∞–ª–æ–Ω</strong> ‚Äì –≤–∞—à –Ω–∞–¥–µ–∂–Ω—ã–π –ø–∞—Ä—Ç–Ω–µ—Ä –≤ –º–∏—Ä–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π! 
                –ú—ã –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º —à–∏—Ä–æ–∫–∏–π –≤—ã–±–æ—Ä –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π, —Ç–µ—Å—Ç-–¥—Ä–∞–π–≤—ã –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å.
            </p>
        </div>
    </div>
</div>
{% endblock %}
